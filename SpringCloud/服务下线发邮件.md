# 服务下线发送邮件

- 配置SpringBootAdminServer端

    - ```xml
        <dependency>
            <groupId>de.codecentric</groupId>
            <artifactId>spring-boot-admin-starter-server</artifactId>
            <version>2.4.1</version>
        </dependency>
        <dependency>
            <groupId>de.codecentric</groupId>
            <artifactId>spring-boot-admin-server-ui</artifactId>
            <version>2.4.1</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-mail</artifactId>
            <version>2.5.1</version>
        </dependency>
        ```

    - yaml 配置

        - ```yaml
            spring:
              boot:
                admin:
                  notify:
                    mail:
                      # 发送方, 与下面的mail要对上号
                      from: 2797162845@qq.com
                      # 接受方, 参数是String[], 可以发送给多个邮箱
                      to: 2797162845@qq.com
              mail:
                # 邮箱smtp地址
                host: smtp.qq.com
                username: 2797162845
                # 从邮箱服务商配置的秘钥
                password: tojotvwyeszsdcig
                properties:
                  mail:
                    smpt:
                      auth: true
                      starttls:
                        enable: true
                        required: true
            ```

- 在需要监控的服务上加入以下依赖

    - ```xml
        <dependency>
            <groupId>de.codecentric</groupId>
            <artifactId>spring-boot-admin-starter-client</artifactId>
            <version>2.4.1</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-actuator</artifactId>
            <version>2.5.1</version>
        </dependency>
        ```

    - yaml 配置

        - ```yaml
            management:
              endpoint:
                health:
                  # 显示详细信息
                  show-details: always
              endpoints:
                web:
                  exposure:
                    # 对外暴露所有服务
                    include: "*"
            
            spring:
              application:
                name: consumer
              boot:
                admin:
                  client: # AdminServer URL
                    url: http://localhost:9090
            ```